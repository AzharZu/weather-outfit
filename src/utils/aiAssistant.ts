import { User } from '../contexts/UserContext';
import { WeatherData } from '../services/weatherService';
import { MoodType } from './moods';

// Direct type definition to avoid circular imports
export type ColorType = 'spring' | 'summer' | 'autumn' | 'winter';

export interface PersonalRemark {
  priority: number;
  icon: string;
  text: string;
  category: 'outfit' | 'style' | 'mood' | 'weather' | 'color';
}

// –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∏–ª–µ–≤—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
function getStyleComment(name: string, style: string): string {
  switch (style) {
    case 'casual':
      return `${name}, —Ç–≤–æ–π casual-—Å—Ç–∏–ª—å –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–≤–æ–µ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –∫–æ–º—Ñ–æ—Ä—Ç–µ! –°–µ–≥–æ–¥–Ω—è –¥–æ–±–∞–≤—å —è—Ä–∫–∏–π –∞–∫—Å–µ—Å—Å—É–∞—Ä –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è! ‚ú®`;
    case 'elegant':
      return `${name}, —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç—å - —Ç–≤–æ—è —Å—É–ø–µ—Ä—Å–∏–ª–∞! –°–µ–≥–æ–¥–Ω—è —Ç—ã –º–æ–∂–µ—à—å –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å–µ–±–µ —Å–º–µ–ª—ã–π —Ü–≤–µ—Ç –∏–ª–∏ –Ω–µ–æ–±—ã—á–Ω—É—é –¥–µ—Ç–∞–ª—å! üíé`;
    case 'sporty':
      return `${name}, —Ç–≤–æ–π —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å –∑–∞—Ä—è–∂–∞–µ—Ç —ç–Ω–µ—Ä–≥–∏–µ–π! –°–µ–≥–æ–¥–Ω—è –ø–æ–ø—Ä–æ–±—É–π —Å—Ç–∏–ª—å–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏ —Å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º –Ω–∞—Ä—è–¥–æ–º! ‚ö°`;
    case 'business':
      return `${name}, –¥–µ–ª–æ–≤–æ–π —Å—Ç–∏–ª—å - —ç—Ç–æ —Ç–≤–æ—è –±—Ä–æ–Ω—è —É—Å–ø–µ—Ö–∞! –î–æ–±–∞–≤—å —á—Ç–æ-—Ç–æ –ª–∏—á–Ω–æ–µ - —è—Ä–∫—É—é –ø–æ–º–∞–¥—É –∏–ª–∏ —Å—Ç–∏–ª—å–Ω—ã–µ —á–∞—Å—ã! üíº`;
    default:
      return `${name}, —Ç–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å - —ç—Ç–æ —Ç–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –æ—Å–æ–±–µ–Ω–Ω–æ–π! –°–µ–≥–æ–¥–Ω—è –ø—Ä–∏—Å–ª—É—à–∞–π—Å—è –∫ —Å–≤–æ–µ–º—É —Å–µ—Ä–¥—Ü—É! üí´`;
  }
}

// –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é
function getMoodComment(name: string, mood: MoodType): string {
  switch (mood) {
    case 'business-lady':
      return `${name}, —Å–µ–≥–æ–¥–Ω—è —Ç—ã - –Ω–∞—Å—Ç–æ—è—â–∞—è –±–∏–∑–Ω–µ—Å-–ª–µ–¥–∏! –ß–µ—Ç–∫–∏–µ –ª–∏–Ω–∏–∏, –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–∫–∞–Ω–∏, –ø—Ä–æ–¥—É–º–∞–Ω–Ω—ã–µ –¥–µ—Ç–∞–ª–∏. –¢—ã –≥–æ—Ç–æ–≤–∞ –ø–æ–∫–æ—Ä—è—Ç—å –¥–µ–ª–æ–≤–æ–π –º–∏—Ä! ÔøΩ`;
    case 'cozy-coffee':
      return `${name}, —É—é—Ç–Ω–æ–µ –∫–∞—Ñ–µ –∏ —Ç–µ–ø–ª—ã–π –∫–æ—Ñ–µ - —Ç–≤–æ—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞! –ú—è–≥–∫–∏–µ —Ç–µ–∫—Å—Ç—É—Ä—ã, —Å–ø–æ–∫–æ–π–Ω—ã–µ —Ç–æ–Ω–∞ –∏ –∫–æ–º—Ñ–æ—Ä—Ç –ø—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ! ‚òï`;
    case 'parisian-elegance':
      return `${name}, –ø–∞—Ä–∏–∂—Å–∫–∞—è —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç—å —Ç–µ—á–µ—Ç –≤ —Ç–≤–æ–∏—Ö –≤–µ–Ω–∞—Ö! –ò–∑—ã—Å–∫–∞–Ω–Ω—ã–µ –¥–µ—Ç–∞–ª–∏, –±–ª–∞–≥–æ—Ä–æ–¥–Ω—ã–µ —Ç–∫–∞–Ω–∏, –±–µ–∑—É–ø—Ä–µ—á–Ω—ã–π –≤–∫—É—Å! ü•ê`;
    case 'rainy-cinema':
      return `${name}, –¥–æ–∂–¥–ª–∏–≤—ã–π –¥–µ–Ω—å - –ø–æ–≤–æ–¥ –¥–ª—è –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞! –í–∏–Ω—Ç–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –∏ –∑–∞–≥–∞–¥–æ—á–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞! ÔøΩ`;
    case 'street-confident':
      return `${name}, —É–ª–∏—Ü—ã - —Ç–≤–æ—è —Å—Ü–µ–Ω–∞! –£–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–∏–ª—É—ç—Ç—ã, —Å–º–µ–ª—ã–µ —Å–æ—á–µ—Ç–∞–Ω–∏—è, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –¥–µ—Ç–∞–ª–∏. –¢—ã –≥–æ—Ç–æ–≤–∞ –ø–æ–∫–æ—Ä—è—Ç—å –º–∏—Ä! ÔøΩ`;
    case 'romantic-dreamy':
      return `${name}, —Ä–æ–º–∞–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –∏ –º–µ—á—Ç–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å - —Ç–≤–æ—è –æ—Å–æ–±–∞—è –º–∞–≥–∏—è! –ù–µ–∂–Ω—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏, —Å—Ç—Ä—É—è—â–∏–µ—Å—è —Ç–∫–∞–Ω–∏, –∂–µ–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∏–ª—É—ç—Ç—ã! üå∏`;
    default:
      return `${name}, —Ç–≤–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ, –∫–∞–∫ –∏ —Ç—ã! –ü—Ä–∏—Å–ª—É—à–∞–π—Å—è –∫ —Å–µ–±–µ –∏ —Å–æ–∑–¥–∞–π –æ–±—Ä–∞–∑ –º–µ—á—Ç—ã! ‚ú®`;
  }
}

// –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ —Ü–≤–µ—Ç–æ—Ç–∏–ø—É
function getColorTypeComment(name: string, colorType?: ColorType): string {
  if (!colorType) {
    return `${name}, –æ–ø—Ä–µ–¥–µ–ª–∏ —Å–≤–æ–π —Ü–≤–µ—Ç–æ—Ç–∏–ø, —á—Ç–æ–±—ã –≤—Å–µ–≥–¥–∞ –≤—ã–≥–ª—è–¥–µ—Ç—å –Ω–∞ –≤—Å–µ 100%! –≠—Ç–æ —Ç–≤–æ–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥ —Å—Ç–∏–ª—è! üé®`;
  }

  switch (colorType) {
    case 'spring':
      return `${name}-–í–µ—Å–Ω–∞, —Ç–≤–æ–∏ —Ü–≤–µ—Ç–∞ - —ç—Ç–æ –ø–µ—Ä—Å–∏–∫–æ–≤—ã–µ, –∫–æ—Ä–∞–ª–ª–æ–≤—ã–µ, –∑–æ–ª–æ—Ç–∏—Å—Ç—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏! –¢—ã —Å–ª–æ–≤–Ω–æ —É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–ª–Ω—Ü–µ! üå∏`;
    case 'summer':
      return `${name}-–õ–µ—Ç–æ, –º—è–≥–∫–∏–µ –∏ –ø—Ä–æ—Ö–ª–∞–¥–Ω—ã–µ —Ç–æ–Ω–∞ - —Ç–≤–æ—è —Å—Ç–∏—Ö–∏—è! –õ–∞–≤–∞–Ω–¥–æ–≤—ã–π, –ø—ã–ª—å–Ω–∞—è —Ä–æ–∑–∞, —Å–µ—Ä–æ-–≥–æ–ª—É–±–æ–π! üåø`;
    case 'autumn':
      return `${name}-–û—Å–µ–Ω—å, –≥–ª—É–±–æ–∫–∏–µ –∏ —Ç–µ–ø–ª—ã–µ —Ü–≤–µ—Ç–∞ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç —Ç–≤–æ—é –∫—Ä–∞—Å–æ—Ç—É! –¢–µ—Ä—Ä–∞–∫–æ—Ç–æ–≤—ã–π, –≥–æ—Ä—á–∏—á–Ω—ã–π, –æ–ª–∏–≤–∫–æ–≤—ã–π! üçÇ`;
    case 'winter':
      return `${name}-–ó–∏–º–∞, –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–µ –∏ —è—Ä–∫–∏–µ —Ü–≤–µ—Ç–∞ - —Ç–≤–æ—è —Å–∏–ª–∞! –ß–∏—Å—Ç—ã–π –±–µ–ª—ã–π, —á–µ—Ä–Ω—ã–π, —è—Ä–∫–æ-–∫—Ä–∞—Å–Ω—ã–π! ‚ùÑÔ∏è`;
    default:
      return `${name}, –∫–∞–∂–¥—ã–π —Ü–≤–µ—Ç–æ—Ç–∏–ø –ø—Ä–µ–∫—Ä–∞—Å–µ–Ω –ø–æ-—Å–≤–æ–µ–º—É! –ù–∞–π–¥–∏ —Å–≤–æ–π –∏ —Å–∏—è–π! üåà`;
  }
}

// –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–≥–æ–¥–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
function getWeatherComment(name: string, weather: WeatherData): string {
  const temp = weather.temperature;

  if (temp < 0) {
    return `${name}, –º–æ—Ä–æ–∑ - –Ω–µ –ø–æ–≤–æ–¥ –≥—Ä—É—Å—Ç–∏—Ç—å! –°—Ç–∏–ª—å–Ω—ã–µ —Å–ª–æ–∏, —É—é—Ç–Ω—ã–µ —Å–≤–∏—Ç–µ—Ä–∞ –∏ —è—Ä–∫–∏–µ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã —Å–æ–≥—Ä–µ—é—Ç –¥—É—à—É! ‚ùÑÔ∏è`;
  } else if (temp < 10) {
    return `${name}, –ø—Ä–æ—Ö–ª–∞–¥–Ω–∞—è –ø–æ–≥–æ–¥–∞ –∏–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ—Å—Ç–∏! –ò–≥—Ä–∞–π —Å —Ç–µ–∫—Å—Ç—É—Ä–∞–º–∏ –∏ —Å–æ–∑–¥–∞–≤–∞–π —É—é—Ç–Ω—ã–µ –æ–±—Ä–∞–∑—ã! üß•`;
  } else if (temp < 20) {
    return `${name}, –∏–¥–µ–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤! –õ–µ–≥–∫–∞—è –∫—É—Ä—Ç–∫–∞ –∏–ª–∏ –∫–∞—Ä–¥igan + –ª—é–±–∏–º—ã–µ –¥–∂–∏–Ω—Å—ã! üå§`;
  } else if (temp < 30) {
    return `${name}, —Ç–µ–ø–ª–∞—è –ø–æ–≥–æ–¥–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–µ–∑–≥—Ä–∞–Ω–∏—á–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏! –õ–µ–≥–∫–∏–µ —Ç–∫–∞–Ω–∏ –∏ —è—Ä–∫–∏–µ –ø—Ä–∏–Ω—Ç—ã! ‚òÄÔ∏è`;
  } else {
    return `${name}, –∂–∞—Ä–∞ - –≤—Ä–µ–º—è –¥–ª—è –≤–æ–∑–¥—É—à–Ω—ã—Ö —Ç–∫–∞–Ω–µ–π –∏ —Å–≤–µ–∂–∏—Ö –æ–±—Ä–∞–∑–æ–≤! –õ–µ–Ω, —Ö–ª–æ–ø–æ–∫ –∏ –ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏! üå°`;
  }
}

// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –∑–∞–º–µ—á–∞–Ω–∏–π
export function generatePersonalRemarks(
  user: User,
  weather: WeatherData,
  mood: MoodType,
  colorType?: ColorType
): PersonalRemark[] {
  const remarks: PersonalRemark[] = [];

  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (—Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π)
  remarks.push({
    priority: 1,
    icon: 'üí´',
    text: getMoodComment(user.name, mood),
    category: 'mood'
  });

  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ü–æ–≥–æ–¥–∞
  remarks.push({
    priority: 2,
    icon: 'üå§',
    text: getWeatherComment(user.name, weather),
    category: 'weather'
  });

  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –°—Ç–∏–ª—å
  remarks.push({
    priority: 3,
    icon: 'üëó',
    text: getStyleComment(user.name, user.style),
    category: 'style'
  });

  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4: –¶–≤–µ—Ç–æ—Ç–∏–ø
  remarks.push({
    priority: 4,
    icon: 'üé®',
    text: getColorTypeComment(user.name, colorType),
    category: 'color'
  });

  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 5: –û–±—â–∏–π —Å–æ–≤–µ—Ç
  const generalAdvice = [
    `${user.name}, –ø–æ–º–Ω–∏ - —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —ç—Ç–æ –ª—É—á—à–∏–π –∞–∫—Å–µ—Å—Å—É–∞—Ä! üí™`,
    `${user.name}, —Ç–≤–æ—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ—Å—Ç—å - —Ç–≤–æ—è —Å—É–ø–µ—Ä—Å–∏–ª–∞! ‚ú®`,
    `${user.name}, —Å—Ç–∏–ª—å - —ç—Ç–æ —Å–ø–æ—Å–æ–± —Å–∫–∞–∑–∞—Ç—å –∫—Ç–æ —Ç—ã, –Ω–µ –ø—Ä–æ–∏–∑–Ω–æ—Å—è –Ω–∏ —Å–ª–æ–≤–∞! üëë`,
    `${user.name}, —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π! –ú–æ–¥–∞ - —ç—Ç–æ –∏–≥—Ä–∞, –ø–æ–ª—É—á–∞–π —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ! üé≠`,
    `${user.name}, –∫–∞—á–µ—Å—Ç–≤–æ –≤—Å–µ–≥–¥–∞ –ø–æ–±–µ–∂–¥–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ! –í—ã–±–∏—Ä–∞–π –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ! üíé`
  ];

  const randomAdvice = generalAdvice[Math.floor(Math.random() * generalAdvice.length)];
  
  remarks.push({
    priority: 5,
    icon: 'üíù',
    text: randomAdvice,
    category: 'outfit'
  });

  return remarks.sort((a, b) => a.priority - b.priority);
}
